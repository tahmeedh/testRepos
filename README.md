## Installation
To install:
```js script
nvm use
npm ci
```
If you are running playwright for the first time, you might also need to do
```js script
npx playwright install
```
## Setup Enviromental Variable
Create a .env file in the jsat-e2e-chat-window folder and fill in the enviroment variables. Don't push the .env file to the repo.
| Variable | Example | Description | 
| --- | --- | --- |
| `SERVER` | `SERVER='cpqa2-va1'` | Run test against this test enviroment:|
| `ADMIN_USERNAME` | `ADMIN_USERNAME='slui@gr.net` | Email of a user with admin privileges|
| `ADMIN_PASSWORD` | `ADMIN_PASSWORD='PasswordOfSlui'` | Password of the above user|


## Run tests
Playwright commands : https://playwright.dev/docs/test-cli
To run test:
| Example | Description | 
| --- | --- |
| SERVER=cpqa2-va1 npx playwright test | run all tests |
| SERVER=cpqa2-va1 npx playwright test -g C2596427 | run specific test |
| SERVER=cpqa2-va1 npx playwright test -g @smoke | run test with specific string in test title |
| SERVER=cpqa2-va1 npx playwright codegen | run playwright codegen |
| npx playwright show-report | run HTML Reporter |

| Flags | Example |
| --- | --- |
| `-g "abcd"` | Run the tests that contain the string "abcd" in test title |
| `--headed` | Run tests in headed browsers |
| `--repeat-each=5` | Run each test N times, defaults to one. |
| `--workers=1` | The maximum number of concurrent worker processes that run in parallel. | 
| `--ui` | -- Run tests in interactive UI mode, with a built-in watch mode (Preview) |

## Conventions

| Flags | Example  | 
| --- | --- |
| Folder name | all lower case and kebab case |
| File name/Test name | kebab case |
| Variable | camel case |
| Constant | All upper case and snake case |

```
TestrailID-TestName(Test name should start with the chat typ(SUC/MUC/SMS/GroupText/WhatsApp/Channel))
C3674156-SMS-mini-vCard-is-displayed-when-hover-over-chat-header-avatar-in-invite.spec.ts

```
### For file that contain only 1 test
Use TestUtils to generate test name and test tags, this will reduce maintiance needed and eliminate files name and test name mismatch.
## TestUtil methods
| Method | Description |
| --- | --- |
| `testName` | Extract test name by file name |
| `testTag` | Generate tags according to folder structure e.g. test/sms/feed-view/footer/test.spec.ts will generate @sms @feed-view @footer|
| `testAnnoation` | Extract TestRail case ID from file name, and return an object that contains the annotation info. This will create a link to testrail on HTML report|
```
import { TestUtils } from 'Helpers/test-utils';
const { testAnnotation, testName, testTags } = TestUtils.getTestInfo(__filename);

```

### To use info generated by TestUtil
```
test(`${testName} ${testTags} @Mini-vCard @Mini-vCard-sanity`, async ({ page }) => {
    test.info().annotations.push(testAnnotation);
    ...
})

```
